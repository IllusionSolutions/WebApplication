<!-- Serves reports, controlled by dashboard.js -->
<div>
    <a ui-sref="overview" class="pull-right btn btn-primary btn-outline btn-rounded">Overview</a>
    <h2>{{selectedDevice.appliance}}</h2>
    <h4>Connected to the {{selectedDevice.name}}</h4>

    <div class="row thumbnail" >
        <ul class="nav nav-pills nav-justified" role="tablist">
            <li role="presentation" class="active"><a role="tab" aria-controls="overview" data-toggle="tab" data-target="#overview">Overview</a></li>
            <li role="presentation"><a role="tab" data-toggle="tab" aria-controls="kwhView" data-target="#kwhView">Kilowatt Hours</a></li>
            <li role="presentation"><a role="tab" data-toggle="tab" aria-controls="currentView" data-target="#currentView">Current</a></li>
            <li role="presentation"><a role="tab" data-toggle="tab" aria-controls="realtimeView" data-target="#realtimeView">Realtime Data</a></li>
            <li role="presentation"><a role="tab" data-toggle="tab" aria-controls="settingsView" data-target="#settingsView">Settings</a></li>
        </ul>
    </div>

    <div class="tab-content">
        <div id="overview" role="tabpanel" class="tab-pane active">
            <div class="row">
                <div class="col-sm-15 col-md-16">
                    <div style="padding: 2%;" class="thumbnail col-sm-1 col-md-3">
                        <h4 class="text-center text-primary"><strong>Voltage Detected:</strong> {{voltage}}</h4>
                        <h4 class="text-center text-warning"><strong>Power Factor:</strong> 1</h4>
                    </div>

                    <div style="padding: 1%; margin-left: 1%;" class="thumbnail col-sm-1 col-md-3">
                        <h4 class="text-center text-primary">Usage Cost:</h4>
                        <h4 class="text-center"><strong>R </strong>{{totalCost}}</h4>

                        <p class="text-center"><small ><i>Only an estimate using <a target="_blank" href="http://www.eskom.co.za/CustomerCare/TariffsAndCharges/Pages/Tariffs_And_Charges.aspx">Eskom</a> tariffs.</i></small></p>
                    </div>


                    <div style="padding: 2%; margin-left: 1%;" class="thumbnail col-sm-1 col-md-2">
                        <h4><strong>Last updated:</strong><br/><small><strong>{{lastUpdate.toLocaleDateString()}}</strong><br/>{{lastUpdate.toLocaleTimeString()}}</small></h4>
                    </div>

                    <div class="pull-right col-sm-2 col-md-3 thumbnail">
                        <h4 class="text-center">Notifications</h4>
                        <hr />
                        <p class="text-center">No new notifications</p>
                    </div>
                </div>
            </div>
            <div class="col-sm-15 col-md-5 row">
                <div class="panel panel-default">
                    <table class="table table-hover">
                        <thead>
                        <tr>
                            <th></th>
                            <th>Current (A)</th>
                            <th>Power (KWh)</th>
                            <th>Cost (R)</th>
                            <th>CO2 Emissions (Kg)</th>
                        </tr>
                        </thead>
                        <tr>
                            <td>Max</td>
                            <td>{{maxCurrent}}</td>
                            <td>{{maxPower}}</td>
                            <td>{{maxCost}}</td>
                            <td>{{maxEmission}}</td>
                        </tr>
                        <tr>
                            <td>Min</td>
                            <td>{{minCurrent}}</td>
                            <td>{{minPower}}</td>
                            <td>{{minCost}}</td>
                            <td>{{minEmission}}</td>
                        </tr>
                        <tr>
                            <td>Average</td>
                            <td>{{avgCurrent}}</td>
                            <td>{{avgPower}}</td>
                            <td>{{avgCost}}</td>
                            <td>{{avgEmission}}</td>
                        </tr>
                        <tr>
                            <td><h5>Total</h5></td>
                            <td>{{totalCurrent}}</td>
                            <td>{{totalPower}}</td>
                            <td>{{totalCost}}</td>
                            <td>{{totalEmission}}</td>
                        </tr>

                        <tfoot>
                            <th><small><i>Source: <a href="https://www.epa.gov/energy/greenhouse-gas-equivalencies-calculator" target="_blank">EPA</a></i></small></th>
                            <th></th> <th></th> <th></th> <th></th>
                        </tfoot>
                    </table>
                </div>
            </div>

        </div>

        <div id="kwhView" role="tabpanel" class="tab-pane">
            <div class="row">
                <highchart style="margin-right: 1%;" class="panel panel-default col-sm-4 col-md-6" id="kwhChart" config="kwhChartConfig">

            </div>
        </div>

        <div id="currentView" role="tabpanel" class="tab-pane">
            <div class="row">
                <highchart style="margin-right: 1%;" class="panel panel-default col-sm-4 col-md-6" id="currentChart" config="chartConfig"></highchart>
                <div class="col-sm-2 col-md-2 well well-sm pull-right" >
                    <h5>Selected Date:</h5>
                    <datepicker date-format="dd MMMM yyyy">
                        <input id="currentDate" name="date" class="col-sm-11 col-md-11" ng-model="date.value" type="text"/>
                    </datepicker>
                </div>
            </div>
        </div>

        <div id="realtimeView" role="tabpanel" class="tab-pane">
            <div class="row">
                <h5>Realtime Statistics</h5>
            </div>
        </div>

        <div id="settingsView" class="tab-pane" role="tabpanel">
            <div class="row">
                <div style="padding: 2%; margin: 1%;"  class="col-sm-2 col-md-4 thumbnail">
                    <h4 class="text-primary">Device Status</h4>
                    <hr/>
                    <p>Device is currently: <span class="label label-danger">Offline</span></p>
                    <p>Device is power is: <span class="label label-danger">Unknown</span></p>
                    <button style="margin-right: 1%;" ng-click="toggleDevice()" type="button" class="btn btn-primary">Toggle Power</button>
                </div>

                <div id="changeNameDiv" style="padding: 2%; margin: 1%;"  class="col-md-3 thumbnail">
                    <h4 class="text-primary">Device Details</h4>
                    <hr/>
                    <form name="deviceNewNameForm">
                        <div class="form-group">
                            <input pattern="[a-zA-Z0-9]+" placeholder="{{selectedDevice.name}}" autocomplete="off" ng-model="deviceNewName" type="text" class="form-control" id="deviceNewName" name="deviceNewName">
                        </div>
                        <button ng-click="changeDeviceName(selectedDevice.id)" style="margin-left: 2%;" type="submit" class="btn btn-primary" id="firebaseURLSubmit">Rename</button>
                    </form>
                    <div style="margin-top: 5%;" ng-show="changeNameSuccess" class="alert alert-success alert-dismissible" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h5>Success</h5>
                    </div>

                    <div style="margin-top: 5%;" ng-show="changeNameFailure" class="alert alert-danger alert-dismissible" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h5>Server Error.</h5>
                    </div>
                </div>

                <div  style="padding: 2%; margin: 1%;"  class="col-md-4 thumbnail">
                    <h4 class="text-primary">Notification Settings</h4>
                    <hr/>
                    <form>
                        <div class="form-group">
                            <input placeholder="Notification Email" autocomplete="off" ng-model="notificationEmail" type="text" class="form-control" id="notificationEmail">
                        </div>
                        <button style="margin-left: 2%;" type="submit" class="btn btn-primary" id="notificationEmailSubmit">Save</button>
                    </form>
                </div>
            </div>

            <div class="row col-sm-4 col-md-6">
                <div class=" panel panel-danger">
                    <div class="panel-heading">Device Management</div>
                    <div class="panel-body">
                        <button style="margin: 10px;" type="button" class="btn btn-danger" id="deleteDevice">Delete Device</button>
                        <button style="margin: 10px;" type="button" class="btn btn-danger" id="unclaimDevice">Unclaim Device</button>
                        <button style="margin: 10px;" type="button" class="btn btn-danger" id="reflashDevice">Flash Device</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
